dependencies:
  post:
    - sudo apt-get -y update
    - sudo apt-get -y install coreutils qemu virtualbox gawk sed curl wget virtualbox-dkms linux-headers-generic
compile:
  override:
    - cd dist && source ../scripts/env/debian-8 && ../scripts/create_images_from_qcow2.sh
    - cd dist && source ../scripts/env/ubuntu-1604 && ../scripts/create_images_from_vmdk.sh xenial-server-cloudimg-amd64
#    - cd dist && source ../scripts/env/centos-7 && ../scripts/create_images_from_qcow2.sh
#    - cd dist && source ../scripts/env/rancheros && ../scripts/create_images_from_qcow2.sh
    - cd dist && ls -l
  post:
    - echo 'no tests yet.'
deployment:
  release:
    branch: master
    commands:
    # Publish assets to Github
    - ghr -t "$GITHUB_TOKEN" -u "$CIRCLE_PROJECT_USERNAME" -r "$CIRCLE_PROJECT_REPONAME" -prerelease -delete "v0.0.$CIRCLE_BUILD_NUM dist/ || true
